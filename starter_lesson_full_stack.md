# Full-Stack Database Project - Starter Lesson
## Get It Working in One Class

By the end of this lesson, you will:
- Create a database table in Oracle
- Expose it as a REST API (automatic - no coding)
- Call it from Python in GitHub Codespaces
- See JSON data in your terminal
- Understand "full-stack" works

This is the foundation. Everything else builds on this.

---

## Part 1: Create Your Database Table (10 minutes)

### Step 1: Log in to APEX

Go to: **https://apex.oracle.com**

Log in with your college credentials.

### Step 2: Open SQL Workshop

From the home menu:
- Click **"SQL Workshop"**
- Click **"SQL Commands"**

### Step 3: Create the POSTS table

Copy-paste this ENTIRE block:

```sql
CREATE TABLE posts (
  id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  text VARCHAR2(200),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO posts(text) VALUES('Hello world');
COMMIT;
```

Then click **"Run"** (green play button).

You should see: `1 row created` and `1 row inserted`

✓ **Part 1 Done**

---

## Part 2: Register Schema with ORDS (5 minutes)

### Step 1: Open RESTful Services

From the main menu:
- Click **"SQL Workshop"**
- Click **"RESTful Services"**

### Step 2: Register your schema

You will see a screen that says:

> "RESTful Data Services - REST Enabled Objects"

Look for a button that says **"Register Schema with ORDS"** or similar.

If the button says "Disable," skip this step (already registered).

If the button says "Register," click it and keep all defaults. Click **"Save"**.

Wait 5-10 seconds for the page to refresh.

✓ **Part 2 Done**

---

## Part 3: Enable REST for the POSTS Table (10 minutes)

### Step 1: Go to Enabled Objects

You should still be in RESTful Services.

Look for **"ORDS REST-Enabled Objects"** on the left menu.

Click it.

### Step 2: Create a REST endpoint

Click **"Create"** (top right button).

A form appears:

- **Object Type**: Select `Table`
- **Schema**: Select your schema
- **Object Name**: Select `POSTS`
- Leave everything else as default

Click **"Create"**

### Step 3: Verify the endpoint was created

You should see a screen showing:

```
Object: POSTS
URI: /ords/<your-schema>/posts/
```

**Copy this full URL** (you'll need it next):

```
https://apex.oracle.com/ords/<your-schema>/posts/
```

Note: Replace `<your-schema>` with your actual schema name (ask instructor if unsure)

### Step 4: Test the endpoint inside APEX

On the same screen, you should see a **"Test"** button.

Click it.

A browser console opens showing the JSON response:

```json
{
  "items": [
    {
      "id": 1,
      "text": "Hello world",
      "created_at": "2025-11-30T10:30:00Z"
    }
  ],
  "hasMore": false,
  "limit": 25,
  "offset": 0,
  "count": 1
}
```

**This is the full-stack moment.** You just called a REST API that read from your database and returned JSON.

✓ **Part 3 Done**

---

## Part 4: Call It From Python in Codespaces (20 minutes)

### Step 1: Open GitHub Codespaces

Create a repo in GitHub named **DBA-120-Full-Stack-Intro** (just copy and paste that). **Make sure you select Add README.**

Click **"Code"** (green button) → **"Codespaces"** → **"Create codespace on main"**

Wait 2-3 minutes for it to load.

### Step 2: Create a new file

In the left sidebar, right-click and select **"New File"**

Name it: `test.py`

### Step 3: Copy-paste this code

```python
import requests
from requests.packages.urllib3.exceptions import InsecureRequestWarning

# Disable SSL warnings
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

# UPDATE THIS WITH YOUR REST URL FROM STEP 3
url = "https://apex.oracle.com/ords/<your-schema>/posts/"

# Add browser headers
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)',
    'Accept': 'application/json'
}

try:
    # Call the REST endpoint
    print("Calling REST API...")
    response = requests.get(url, headers=headers, timeout=30, verify=False)
    
    print(f"Status Code: {response.status_code}")
    
    if response.status_code == 200:
        data = response.json()
        print("\n✓ SUCCESS! Got JSON data:")
        print(data)
    else:
        print(f"Error: {response.status_code}")
        print(response.text)
        
except Exception as e:
    print(f"Connection error: {e}")
```

### Step 4: Update the URL

Find this line in the code:
```python
url = "https://apex.oracle.com/ords/<your-schema>/posts/"
```

Replace `<your-schema>` with your actual schema name.

**Example:**
```python
url = "https://apex.oracle.com/ords/dba120l01/posts/"
```

### Step 5: Open Terminal in Codespaces

Click **"Terminal"** (top menu) → **"New Terminal"**

### Step 6: Run the Python script

In the terminal, type:
```bash
python3 test.py
```

Press Enter.

### Step 7: You should see output like:

```
Calling REST API...
Status Code: 200

✓ SUCCESS! Got JSON data:
{'items': [{'id': 1, 'text': 'Hello world', 'created_at': '2025-11-30T10:30:00Z'}], 'hasMore': False, 'limit': 25, 'offset': 0, 'count': 1}
```

**If you see this, you're done.** You just called your Oracle database from Python. That's full-stack.

✓ **Part 4 Done**

---

## Part 5: Test POST (Write to Database) - (15 minutes)

Now test that you can **write** to the database from Python.

### Step 1: Create a new file

In Codespaces, create another file: `test_post.py`

### Step 2: Copy-paste this code

```python
import requests
import json
from requests.packages.urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

# UPDATE THIS WITH YOUR URL
url = "https://apex.oracle.com/ords/<your-schema>/posts/"

headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64)',
    'Content-Type': 'application/json',
    'Accept': 'application/json'
}

# Data to POST
payload = {
    "text": "Created from Python in Codespaces"
}

try:
    print("Creating new post via REST API...")
    response = requests.post(
        url,
        data=json.dumps(payload),
        headers=headers,
        timeout=30,
        verify=False
    )
    
    print(f"Status Code: {response.status_code}")
    
    if response.status_code == 201:
        print("✓ SUCCESS! Post created:")
        print(response.json())
    else:
        print(f"Error: {response.status_code}")
        print(response.text)
        
except Exception as e:
    print(f"Connection error: {e}")
```

### Step 3: Update the URL

Replace `<your-schema>` with your actual schema.

### Step 4: Run it

In terminal:
```bash
python3 test_post.py
```

### Step 5: Expected output

```
Creating new post via REST API...
Status Code: 201

✓ SUCCESS! Post created:
{'id': 2, 'text': 'Created from Python in Codespaces', 'created_at': '2025-11-30T11:15:00Z'}
```

### Step 6: Verify it worked

Run the GET script again:
```bash
python3 test.py
```

You should now see **2 posts** in the response:
1. "Hello world" (original)
2. "Created from Python in Codespaces" (the one you just created)

✓ **Part 5 Done**

---

## Summary: What You Just Did

```
Oracle Database (Table "posts")
           ↓ (REST API - automatic)
APEX REST Endpoint
           ↓ (HTTP calls from Python)
Python in GitHub Codespaces
```

You proved:
1. Database can store data
2. APEX exposes it as REST (no code required)
3. Python can READ from it (GET)
4. Python can WRITE to it (POST)
5. This all works in GitHub Codespaces

**This is the foundation of the full-stack project.**

---

## If It Doesn't Work

**Problem**: "Connection timed out"
- **Fix**: Check your URL is correct (copy from APEX directly)
- **Fix**: Make sure you're connected to college network/VPN

**Problem**: "404 Not Found"
- **Fix**: Double-check schema name in URL
- **Fix**: Verify REST is enabled in APEX

**Problem**: "Certificate verification failed"
- **Fix**: Already handled (`verify=False` in code)

**Problem**: "ModuleNotFoundError: No module named requests"
- **Fix**: Codespaces has it pre-installed. Close terminal, open new one.

**Problem**: "Connection refused"
- **Fix**: APEX server might be down. Try accessing APEX in browser first.

---

## Next Class

Once this works, you're ready for the full project:
- Build multiple tables (users, posts, comments, reactions)
- Create APEX pages (feed, create post, leaderboard)
- Build analytics in Python (top posters, trending, moderation)

But today, you've proven the core concept: **database → REST → backend code**.

That's full-stack.
